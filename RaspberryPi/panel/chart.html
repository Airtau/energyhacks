<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="FLM database chart">
<title>Fluksometer Database Readings</title>
<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/socket.io.min.js"></script>
<script type="text/javascript" src="js/jquery.flot.js"></script>
<script type="text/javascript" src="js/jquery.flot.time.js"></script>
<script type="text/javascript">
  var fromDate = localStorage.getItem("fromDate");
  var fromTime = localStorage.getItem("fromTime");
  var toDate = localStorage.getItem("toDate");
  var toTime = localStorage.getItem("toTime");
// prepare channel to server
  var socket = io.connect(location.host);
  socket.on('connect', function () {
/*
    socket.on('series', function (res) { 
      var chart = [];
      for (var i in res) chart.push(res[i]);
      //$.plot("#chart", chart, { 
      //  xaxis: { mode: "time"}, 
      //  yaxis: { min: 0}
      //});
      $("#dump").html('hello');
    });
*/
    socket.on('hello', function(res) {
      $("#dump").html(res);
    });
  })
// executed after rendering the complete page; alternative: $(function() {});
	$(document).ready(function() {
		var dNow = new Date();
                var day = dNow.getDate();
                day = (day<10?'0'+day:day);
                var month = dNow.getMonth()+1;
                month = (month<10?'0'+month:month);
                var hrs = dNow.getHours();
                hrs = (hrs<10?'0'+hrs:hrs);
                var min = dNow.getMinutes();
                min = (min<10?'0'+min:min);
                var sec = dNow.getSeconds();
                sec = (sec<10?'0'+sec:sec);
		var localDate = dNow.getFullYear() + '-' + month + '-' + day;
		var localTime = hrs + ':' + min + ':' + sec;

		if (fromDate == null || fromDate == '') fromDate = localDate;
		if (fromTime == null || fromTime == '') fromTime = localTime;
		if (toDate == null || toDate == '') toDate = localDate;
		if (toTime == null || toTime == '') toTime = localTime;
		$('#fromDate').val(fromDate);
		$('#fromTime').val(fromTime);
		$('#toDate').val(toDate);
		$('#toTime').val(toTime);	

		$('#refresh').click(function() {
		localStorage.setItem('fromDate', '');
		localStorage.setItem('fromTime', '');
		localStorage.setItem('toDate', '');
		localStorage.setItem('toTime', '');
		});

		$('#submit').click(function() {
		localStorage.setItem('fromDate', $('#fromDate').val());
		localStorage.setItem('fromTime', $('#fromTime').val());
		localStorage.setItem('toDate', $('#toDate').val());
		localStorage.setItem('toTime', $('#toTime').val());
		});
	});
</script>
</head>
<body>
<div id="input" class="panel panel-default">
<div class="panel-body">
<form method="post" enctype="application/x-www-form-urlencoded">
<table class="table">
<tr><td></td><td>Date</td><td>Time</td></tr>
<tr><td>From</td>
    <td><input id="fromDate" type="date" name="fromDate"/></td>
    <td><input id="fromTime" type="time" name="fromTime"/></td></tr>
<tr><td>To</td>
    <td><input id="toDate" type="date" name="toDate"/></td>
    <td><input id="toTime" type="time" name="toTime"/></td></tr>
<tr><td colspan=3 align="center"><input type="submit" id="submit" value="Submit"/><input type="submit" id="refresh" value="Refresh"/></td></tr>
</table>
</form>
</div>
</div>
<div class="container">
<div id="chart" style="width:800px; height:600px; line-height:1.2em"></div>
</div>
<div class="panel">
<div class="panel-body">
<small id="dump"></small>
</div>
</div>
</body>
</html>
